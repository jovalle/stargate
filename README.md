<div align="center">

<img src="./.github/assets/logo.png" height="400"/>

# Stargate

Provides a warp link strong enough to call ships to a planet's surface

</div>

## ‚ú® Overview

Stargate is a batteries-included Docker Compose collection that keeps a homelab reachable, observable, and secure. It brings together reverse proxies, DNS, certificate management, telemetry, and automated updates so day-to-day upkeep stays low-effort while resiliency stays high.

## üöÄ Highlights

- End-to-end encrypted access for internal services without opening inbound firewall ports.
- Automated DNS, certificate issuance, and dynamic IP syncing for smooth domain management.
- Unified observability via uptime checks, resource metrics, and health dashboards.
- Safe automation layers (socket proxy, watchtower) that reduce blast radius while enabling self-healing updates.
- Built for portability: drop the stack on any Docker-capable host and customize via environment variables. Works well with [nexus](https://github.com/jovalle/nexus)!

## üß∞ Service Lineup

| Service | Purpose | Notes |
| --- | --- | --- |
| AdGuard Home | DNS-level filtering and DHCP | Primary network edge with optional multi-instance sync. |
| AdGuardHome Sync | Config sync | Keeps multiple AdGuard nodes aligned. |
| Beszel Agent | Lightweight telemetry | Streams host metrics into the Beszel dashboard. |
| Cloudflare DDNS | Dynamic DNS | Updates public DNS with the current WAN IP. |
| Cloudflared | Zero-trust tunnels | Publishes internal services through Cloudflare without port forwarding. |
| Docker Socket Proxy | Hardened Docker access | Limits what dashboards can trigger against the Docker daemon. |
| Nginx Proxy Manager | TLS reverse proxy | Friendly UI for ingress rules and certificates. |
| Node Exporter | System metrics | Prometheus-compatible metrics endpoint for the host. |
| Orb | Latency & throughput checks | Speed tests and monitoring. |
| Tailscale | Mesh VPN | Securely links remote clients to the homelab network. |
| Traefik | Smart edge router | Automates HTTPS via Let's Encrypt and routes to services. |
| Uptime Kuma | Synthetic monitoring | Pings, HTTP checks, keyword checks, and alerting. |
| Watchtower | Automated updates | Rolls containers forward on new image builds. |

## üõ†Ô∏è Getting Started

### Install

1. Clone the repository to your homelab host.

   ```sh
   git clone https://github.com/jovalle/stargate.git
   cd stargate
   ```

2. Create `.env`  and populate it with your secrets (see the table below). It should not be committed (as per `.gitignore`) but tread carefully anyways.

   ```sh
   vim .env
   ```

3. Review `docker-compose.yaml` and adjust any service-specific volumes, ports, or networks.

4. Bring the stack online.

   ```sh
   docker compose up -d
   ```

5. Visit the exposed web UIs (for example Traefik, Nginx Proxy Manager, Uptime Kuma) through your tunnel or VPN and finish any first-run onboarding.

### Updating

- To refresh service images manually: `docker compose pull && docker compose up -d`.
- Watchtower is enabled by default. If you prefer manual control, disable or set its scope in `docker-compose.yaml`.

## üîê Environment Variables

All secrets and configuration values live in `.env`. The compose file reads them automatically at deploy time. Rotate them regularly and store backups in your secret manager of choice.

| Variable | Description | Example Value |
| --- | --- | --- |
| `ADGUARD_ADMIN_PASSWORD_HASHED` | Bcrypt-hashed admin password for AdGuard Home. | `$2a$10$<bcrypt-hash>` |
| `ADGUARD_ADMIN_PASSWORD` | Plaintext admin password for first-time setup (optional once hashed). | `replace-me-strong-pass` |
| `ADMIN_EMAIL` | Email used for dashboards, alerts, and ACME registration. | `admin@example.com` |
| `ADMIN_PASSWORD` / `ADMIN_USERNAME` | Shared admin user credentials for UI components that require them. | `stargate-admin` / `super-secure-pass` |
| `ADMIN2_PASSWORD` | Secondary admin credential where required. | `another-strong-pass` |
| `BAZARR_API_KEY` | API token for Bazarr integrations. | `bazarr_api_key_here` |
| `BESZEL_KEY` | Beszel agent enrollment key. | `ssh-ed25519 AAAA...` |
| `CLOUDFLARE_API_TOKEN` / `CLOUDFLARE_EMAIL` | Cloudflare API credentials for DNS updates. | `cf_api_token_goes_here` / `me@example.com` |
| `CLOUDFLARED_TOKEN` | Tunnel token generated by Cloudflare Zero Trust. | `eyJhbGciOi...` |
| `DOMAIN`, `DOMAIN_EXT`, `DOMAIN_INT` | Primary vanity domain plus external/internal zones. | `example.net`, `example.com`, `home.example` |
| `HOST_IP` | LAN IP of the Docker host. | `192.168.1.10` |
| `KROMGO_URL` | Metrics endpoint consumed by internal dashboards. | `https://grafana.example.com/api/...` |
| `PGID` / `PUID` | Group and user IDs used for container file ownership. | `1000` |
| `PORTAINER_API_KEY` | Scoped API key for Portainer automations. | `ptr_<redacted>` |
| `SABNZBD_API_KEY` | API key for SABnzbd automation. | `sabnzbd_api_key_here` |
| `TAILSCALE_AUTH_KEY` | Reusable or single-use auth key for Tailscale enrollment. | `tskey-auth-<redacted>` |
| `TAILSCALE_DEVICE_ID` / `TAILSCALE_DEVICE_KEY` | Tailscale device credentials (rotate every 90 days). | `device-id-here` / `tskey-api-<redacted>` |
| `TELEGRAM_BOT_API_KEY` / `TELEGRAM_BOT_CHAT_ID` | Telegram bot credentials for alerting. | `telegram_bot_api_key` / `123456789` |
| `TZ` | Host timezone in tz database format. | `America/New_York` |

> ‚ùóÔ∏è Tip: keep real secrets in `.env` or a secret manager like 1Password or Vault, then inject them into the host environment before running `docker compose up`.

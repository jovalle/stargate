version: "3"
services:
  cloudflared:
    image: docker.io/cloudflare/cloudflared:latest
    container_name: cloudflared
    env_file: .env
    restart: "unless-stopped"
    command: "tunnel --no-autoupdate run --token ${CLOUDFLARED_TOKEN}"
  ddns:
    image: oznu/cloudflare-ddns:latest
    container_name: ddns
    env_file: .env
    restart: "unless-stopped"
  pihole:
    image: pihole/pihole:latest
    container_name: pihole
    env_file: .env
    restart: "unless-stopped"
    network_mode: "host"
    cap_add:
      - NET_ADMIN
    volumes:
      - ./etc/pihole:/etc/pihole
      - ./etc/dnsmasq.d:/etc/dnsmasq.d
